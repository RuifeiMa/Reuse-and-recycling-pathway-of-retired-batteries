% function [CO2_Hydro_kWh,CO2_Direct_kWh,CO2_Pyro_kWh,Cost_Hydro_kWh,Cost_Direct_kWh,Cost_Pyro_kWh] = NMCRecycle(SOH,PacTotMod,PacBMSMass,PacjacMass,PacCompMass,PacCoolMass,PacConnMass,PacTotMass,BattEner)
% run NMCMaterials.m;
%%%%%%%%% Recycle %%%%%
%%%%%%%%% Pack %%%%%
CO2_PacRec = [CO2_PacRec_Input -CO2_PacRec_Output].*[1 0.01 0.03 1 1 1 0.9 0.9 0.9].* ...
    [BattEner*SOH1*0.5 PacTotMass PacTotMass PacCoolMass PacjacMass PacBMSMass (ModWallMass/1000*PacTotMod+ModPlateMass/1000*PacTotMod) (ModTermMass/1000*PacTotMod+PacConnMass) PacCompMass];
% 0.5 means 50% SOC when batteries are recycled
if strcmp("EV",Mode)
global CO2_PacRec_EV
CO2_PacRec_EV = [CO2_PacRec_Input -CO2_PacRec_Output].*[0 0.01 0.03 1 1 1 0.9 0.9 0.9].* ...
    [BattEner*SOH1*0.5 PacTotMass PacTotMass PacCoolMass PacjacMass PacBMSMass (ModWallMass/1000*PacTotMod+ModPlateMass/1000*PacTotMod) (ModTermMass/1000*PacTotMod+PacConnMass) PacCompMass];
end
%%%%%%%%% Hydro %%%%%
CO2_Hydro = [CO2_Hydro_Input -CO2_Hydro_Output].* ...
    [PosAcMass/1000/96.928*SOH1/2*98 PosAcMass/1000/96.928*(2-SOH1)/3*17 PosAcMass/1000/96.928*SOH1/2*106 CellTotMass/1000*500 CellTotMass/1000/1000*500 ...
    PosAcMass/1000/96.928*SOH1/2*73.88*94/100 PosAcMass/1000/96.928*0.6*154.69*94/100 PosAcMass/1000/96.928*0.2*154.93*94/100 PosAcMass/1000/96.928*0.2*150.94*94/100 ...
    NegAcMass/1000/1000*94/100 (PosCCMass+PosTermMass)/1000*93/100 (NegCCMass+NegTermMass)/1000*93/100]*...
    ModTotCell*ModParaCell*PacTotMod;
CO2_Hydro_kWh = (sum(CO2_PacRec)+sum(CO2_Hydro))/BattEner;
%%%%%%%%% Direct %%%%%
CO2_Direct = [CO2_Direct_Input -CO2_Direct_Output].* ...
    [PosAcMass/1000/96.928*(1-SOH1)/2*73.88 CellTotMass/1000*200 CellTotMass/1000/1000*300 ...
    PosAcMass/1000/96.928*96.928*90/100 NegAcMass/1000*90/100 (PosCCMass+PosTermMass)/1000*90/100 (NegCCMass+NegTermMass)/1000*90/100]* ...
    ModTotCell*ModParaCell*PacTotMod;
CO2_Direct_kWh = (sum(CO2_PacRec)+sum(CO2_Direct))/BattEner;
%%%%%%%%% Pyro %%%%%
CO2_Pyro = [CO2_Pyro_Input -CO2_Pyro_Output].* ...
    [((SOH1/2+1)*PosAcMass/1000/96.928+(PosCCMass+PosTermMass)/1000/27*1.5+(NegCCMass+NegTermMass)/1000/63.546)*98 CellTotMass/1000*0.026 PosAcMass/1000/96.928*SOH1/2*106 CellTotMass/1000*200 ...
    CellTotMass/1000/1000*1000 ...
    PosAcMass/1000/96.928*SOH1/2*73.88*94/100 PosAcMass/1000/96.928*0.6*154.69*94/100 PosAcMass/1000/96.928*0.2*154.93*94/100 PosAcMass/1000/96.928*0.2*150.94*94/100 ...
    0 (PosCCMass+PosTermMass)/1000*93/100 (NegCCMass+NegTermMass)/1000*93/100]*ModTotCell*ModParaCell*PacTotMod;
CO2_Pyro_kWh = (sum(CO2_PacRec)+sum(CO2_Pyro))/BattEner;

%%%%%%%%% Recycle %%%%%
%%%%%%%%% Pack %%%%%
Cost_PacRec = [Cost_PacRec_Input -Cost_PacRec_Output].*[1 1 1 1 1 1 0.9 0.9 0.9].* ...
    [BattEner*SOH1*0.5 PacTotMass PacTotMass PacCoolMass PacjacMass PacBMSMass (ModWallMass/1000*PacTotMod+ModPlateMass/1000*PacTotMod) (ModTermMass/1000*PacTotMod+PacConnMass) PacCompMass];
%%%%%%%%% Hydro %%%%%
Cost_Hydro = [Cost_Hydro_Input -Cost_Hydro_Output].* ...
    [PosAcMass/1000 PosAcMass/1000/96.928*SOH1/2*98 PosAcMass/1000/96.928*(2-SOH1)/3*17 PosAcMass/1000/96.928*SOH1/2*106 CellTotMass/1000*500 CellTotMass/1000/1000*500 ...
    CellTotMass/1000 CellTotMass/1000 CellTotMass/1000 CellTotMass/1000 ...
    PosAcMass/1000/96.928*SOH1/2*73.88*94/100 PosAcMass/1000/96.928*0.6*154.69*94/100 PosAcMass/1000/96.928*0.2*154.93*94/100 PosAcMass/1000/96.928*0.2*150.94*94/100 ...
    NegAcMass/1000/1000*94/100 (PosCCMass+PosTermMass)/1000*93/100 (NegCCMass+NegTermMass)/1000*93/100]* ...
    ModTotCell*ModParaCell*PacTotMod;
Cost_Hydro_kWh = (sum(Cost_PacRec)+sum(Cost_Hydro))/BattEner;
%%%%%%%%% Direct %%%%%
Cost_Direct = [Cost_Direct_Input -Cost_Direct_Output].* ...
    [PosAcMass/1000 PosAcMass/1000/96.928*(1-SOH1)/2*73.88 CellTotMass/1000*200 CellTotMass/1000/1000*300 ...
    CellTotMass/1000 CellTotMass/1000 CellTotMass/1000 CellTotMass/1000 ...
    PosAcMass/1000/96.928*96.928*90/100 NegAcMass/1000*90/100 (PosCCMass+PosTermMass)/1000*90/100 (NegCCMass+NegTermMass)/1000*90/100]* ...
    ModTotCell*ModParaCell*PacTotMod;
Cost_Direct_kWh = (sum(Cost_PacRec)+sum(Cost_Direct))/BattEner;
%%%%%%%%% Pyro %%%%%
Cost_Pyro = [Cost_Pyro_Input -Cost_Pyro_Output].* ...
    [PosAcMass/1000 ((SOH1/2+1)*PosAcMass/1000/96.928+(PosCCMass+PosTermMass)/1000/27*1.5+(NegCCMass+NegTermMass)/1000/63.546)*98 CellTotMass/1000*0.026 PosAcMass/1000/96.928*SOH1/2*106 CellTotMass/1000*200 ...
    CellTotMass/1000/1000*1000 ...
    CellTotMass/1000 CellTotMass/1000 CellTotMass/1000 CellTotMass/1000 ...
    PosAcMass/1000/96.928*SOH1/2*73.88*94/100 PosAcMass/1000/96.928*0.6*154.69*94/100 PosAcMass/1000/96.928*0.2*154.93*94/100 PosAcMass/1000/96.928*0.2*150.94*94/100 ...
    0 (PosCCMass+PosTermMass)/1000*93/100 (NegCCMass+NegTermMass)/1000*93/100]* ...
    ModTotCell*ModParaCell*PacTotMod;
Cost_Pyro_kWh = (sum(Cost_PacRec)+sum(Cost_Pyro))/BattEner;
% end